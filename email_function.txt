
        // E-Mail Reminder Function
        async function sendSmartReminder() {
            // Admin check
            if (sessionStorage.getItem('adminLoggedIn') !== 'true') {
                alert('Nicht autorisiert!');
                return;
            }
            
            // Get current participant count
            const currentCount = currentData.participants.length;
            
            // Update participant count in UI
            document.getElementById('participantCount').textContent = currentCount;
            
            // Security confirmation
            if (!confirm(\`Wirklich personalisierte E-Mails an alle \${currentCount} Teilnehmer versenden?\n\nJeder erhält automatisch die passende Variante:\n- Normale Teilnehmer: Nur Fest-Erinnerung\n- Aufbau-Helfer: + Aufbau-Info (22.08., 16:00)\n- Abbau-Helfer: + Abbau-Info (24.08., 14:00)\n- Beide: + beide Termine\`)) {
                return;
            }
            
            const statusDiv = document.getElementById('emailStatus');
            statusDiv.className = '';
            statusDiv.style.display = 'none';
            
            try {
                statusDiv.innerHTML = '⏳ E-Mails werden vorbereitet...';
                statusDiv.style.background = '#d4edda';
                statusDiv.style.color = '#155724';
                statusDiv.style.borderLeft = '4px solid #28a745';
                statusDiv.style.display = 'block';
                
                const response = await fetch('https://automatisierung.frankrath.de/webhook/send-smart-reminder', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' }
                });
                
                if (response.ok) {
                    statusDiv.innerHTML = \`✅ Personalisierte E-Mails werden an \${currentCount} Teilnehmer versendet...<br><small>Die Versendung läuft im Hintergrund und kann einige Minuten dauern.</small>\`;
                } else {
                    throw new Error('Server-Fehler');
                }
            } catch (error) {
                console.error('Error sending reminder:', error);
                statusDiv.innerHTML = '❌ Fehler beim Versand! Bitte prüfen Sie die n8n-Workflows.';
                statusDiv.style.background = '#f8d7da';
                statusDiv.style.color = '#721c24';
                statusDiv.style.borderLeft = '4px solid #dc3545';
                statusDiv.style.display = 'block';
            }
        }
