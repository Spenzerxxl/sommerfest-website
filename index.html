<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sommerfest 2025 - Anmeldung</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', serif;
            background-color: #f5f7fa;
            color: #2c3e50;
            line-height: 1.6;
        }

        .container {
            display: flex;
            min-height: 100vh;
        }

        .main-content {
            flex: 1;
            padding: 40px;
            max-width: 800px;
            margin: 0 auto;
        }

        .sidebar {
            width: 350px;
            background-color: #1e3a5f;
            color: white;
            padding: 30px;
            overflow-y: auto;
            box-shadow: -2px 0 10px rgba(0,0,0,0.1);
        }

        .sidebar-left {
            background-color: #2c5282;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
        }

        .simple-header {
            background: linear-gradient(135deg, #1e3a5f 0%, #2c5282 100%);
            color: white;
            padding: 25px 20px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .simple-header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .simple-header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .form-container {
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-top: 30px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #1e3a5f;
        }

        input[type="text"],
        input[type="email"],
        select,
        textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e6ed;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        input[type="text"]:focus,
        input[type="email"]:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: #3498db;
        }

        .button {
            background: linear-gradient(135deg, #1e3a5f 0%, #2c5282 100%);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            width: 100%;
            font-weight: bold;
        }

        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .button:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .button-secondary {
            background: #34495e;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .button-secondary:hover {
            background: #2c3e50;
        }

        .buffet-item {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .buffet-item input {
            flex: 1;
        }

        .buffet-item button {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }

        .buffet-item button:hover {
            background: #c0392b;
        }

        .sidebar h3 {
            color: #f39c12;
            margin-bottom: 20px;
            font-size: 1.4em;
            border-bottom: 2px solid #f39c12;
            padding-bottom: 10px;
        }

        .contribution-list {
            list-style: none;
            padding: 0;
        }

        .contribution-item {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 8px;
            border-left: 4px solid #f39c12;
        }

        .contribution-item strong {
            color: #f39c12;
            display: block;
            margin-bottom: 5px;
        }

        .preferences-section {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
        }

        .preferences-section h3 {
            color: #f39c12;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .preferences-category {
            margin-bottom: 20px;
        }

        .preferences-category h5 {
            color: #ecf0f1;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .checkbox-item input[type="checkbox"] {
            width: auto;
            margin: 0;
        }

        .checkbox-item label {
            margin: 0;
            font-weight: normal;
            color: #ecf0f1;
        }

        .preferences-textarea {
            width: 100%;
            min-height: 60px;
            padding: 10px;
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 6px;
            background: rgba(255,255,255,0.1);
            color: white;
            font-family: inherit;
            resize: vertical;
        }

        .preferences-textarea::placeholder {
            color: rgba(255,255,255,0.7);
        }

        @media (max-width: 1200px) {
            .container {
                flex-direction: column;
            }
            
            .sidebar,
            .sidebar-left {
                width: 100%;
                order: 2;
            }
            
            .main-content {
                order: 1;
                max-width: 100%;
            }
        }

        @media (max-width: 768px) {
            .main-content {
                padding: 20px;
            }
            
            .form-container {
                padding: 20px;
            }
            
            .sidebar,
            .sidebar-left {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Grillbuffet- und Getr√§nke-Pr√§ferenzen Sidebar (Links) -->
        <div class="sidebar sidebar-left">
            <div class="preferences-section">
                <h3>üçñ Grillbuffet-Pr√§ferenzen</h3>
                <p style="font-size: 0.9em; margin-bottom: 15px; color: #bdc3c7;">
                    Mehrfachauswahl m√∂glich - hilft uns bei der Bestellplanung
                </p>
                
                <div class="preferences-category">
                    <h5>Wurst:</h5>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="wurst_bratwurst" value="Bratwurst">
                            <label for="wurst_bratwurst">Bratwurst</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="wurst_rostbratwurst" value="Rostbratwurst">
                            <label for="wurst_rostbratwurst">Rostbratwurst</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="wurst_schinkenwurst" value="Schinkenwurst">
                            <label for="wurst_schinkenwurst">Schinkenwurst</label>
                        </div>
                    </div>
                </div>

                <div class="preferences-category">
                    <h5>Fleisch:</h5>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="fleisch_haehnchenbrust" value="H√§hnchenbrust">
                            <label for="fleisch_haehnchenbrust">H√§hnchenbrust</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="fleisch_schweinenacken" value="Schweinenacken">
                            <label for="fleisch_schweinenacken">Schweinenacken</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="fleisch_putenbrust" value="Putenbrust">
                            <label for="fleisch_putenbrust">Putenbrust</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="fleisch_rind" value="Rind">
                            <label for="fleisch_rind">Rind</label>
                        </div>
                    </div>
                </div>

                <div class="preferences-category">
                    <h5>Vegetarisch/Vegan:</h5>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="veg_grillgemuese" value="Grillgem√ºse">
                            <label for="veg_grillgemuese">Grillgem√ºse</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="veg_halloumi" value="Halloumi">
                            <label for="veg_halloumi">Halloumi</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="veg_vegan_wurst" value="Vegane Wurst">
                            <label for="veg_vegan_wurst">Vegane Wurst</label>
                        </div>
                    </div>
                </div>

                <textarea class="preferences-textarea" id="grillbuffet_bemerkungen" placeholder="Spezielle W√ºnsche zum Grillbuffet..."></textarea>
            </div>

            <div class="preferences-section">
                <h3>üç∫ Getr√§nke-Pr√§ferenzen</h3>
                <p style="font-size: 0.9em; margin-bottom: 15px; color: #bdc3c7;">
                    Mehrfachauswahl m√∂glich - hilft uns bei der Bestellplanung
                </p>
                
                <div class="preferences-category">
                    <h5>Softdrinks:</h5>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="soft_cola" value="Cola">
                            <label for="soft_cola">Cola</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="soft_fanta" value="Fanta">
                            <label for="soft_fanta">Fanta</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="soft_sprite" value="Sprite">
                            <label for="soft_sprite">Sprite</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="soft_wasser" value="Wasser">
                            <label for="soft_wasser">Wasser</label>
                        </div>
                    </div>
                </div>

                <div class="preferences-category">
                    <h5>Alkoholfrei:</h5>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="alkfrei_pils" value="Alkoholfreies Pils">
                            <label for="alkfrei_pils">Alkoholfreies Pils</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="alkfrei_weizen" value="Alkoholfreies Weizen">
                            <label for="alkfrei_weizen">Alkoholfreies Weizen</label>
                        </div>
                    </div>
                </div>

                <div class="preferences-category">
                    <h5>Bier:</h5>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="bier_pils" value="Pils">
                            <label for="bier_pils">Pils</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="bier_weizenbier" value="Weizenbier">
                            <label for="bier_weizenbier">Weizenbier</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="bier_weissbier" value="Wei√übier">
                            <label for="bier_weissbier">Wei√übier</label>
                        </div>
                    </div>
                </div>

                <div class="preferences-category">
                    <h5>Wein/Sekt:</h5>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="wein_rotwein" value="Rotwein">
                            <label for="wein_rotwein">Rotwein</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="wein_weisswein" value="Wei√üwein">
                            <label for="wein_weisswein">Wei√üwein</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="wein_prosecco" value="Prosecco">
                            <label for="wein_prosecco">Prosecco</label>
                        </div>
                    </div>
                </div>

                <textarea class="preferences-textarea" id="getraenke_bemerkungen" placeholder="z.B. Gerne auch alkoholfreies Bier..."></textarea>
            </div>
        </div>

        <div class="main-content">
            <div class="simple-header">
                <h1>Sommerfest 2025</h1>
                <p>Anmeldung f√ºr die L√ºbecker Freimaurer-Logen</p>
            </div>

            <div class="form-container">
                <p style="margin-bottom: 30px; font-size: 1.1em; color: #555;">
                    Wie gewohnt erwartet euch ein k√∂stliches Grillbuffet mit Fleisch, Gefl√ºgel und vielen weiteren Leckereien f√ºr 18‚Ç¨ (inkl. Eintritt). Dazu gestalten wir gemeinsam ein buntes Beilagen-Buffet aus euren Beitr√§gen.
                </p>
                <p style="margin-bottom: 30px; font-size: 1.1em; color: #555;">
                    <strong>Bitte tragt links ein, was ihr euch f√ºr das Grillbuffet und f√ºr die Getr√§nke w√ºnscht - Mehrfachnennung ist ausdr√ºcklich erlaubt!</strong> Eure Angaben helfen uns dabei, die Bestellung optimal zu planen.
                </p>

                <form id="anmeldung-form">
                    <div class="form-group">
                        <label for="name">Name</label>
                        <input type="text" id="name" name="name" required>
                    </div>

                    <div class="form-group">
                        <label for="email">E-Mail</label>
                        <input type="email" id="email" name="email" required>
                    </div>

                    <div class="form-group">
                        <label for="loge">Loge</label>
                        <select id="loge" name="loge" required>
                            <option value="">Bitte w√§hlen</option>
                            <option value="Zum F√ºllhorn">Zum F√ºllhorn</option>
                            <option value="Zur Weltkugel">Zur Weltkugel</option>
                            <option value="Zur Nordischen Krone">Zur Nordischen Krone</option>
                            <option value="Gast">Gast</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="personen">Anzahl Personen</label>
                        <select id="personen" name="personen" required>
                            <option value="">Bitte w√§hlen</option>
                            <option value="1">1 Person</option>
                            <option value="2">2 Personen</option>
                            <option value="3">3 Personen</option>
                            <option value="4">4 Personen</option>
                            <option value="5">5 Personen</option>
                            <option value="6">6 Personen</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="begleitung">Namen der Begleitung</label>
                        <input type="text" id="begleitung" name="begleitung" placeholder="z.B. Maria Mustermann, Johann Schmidt">
                    </div>

                    <h2>Buffet-Beitr√§ge</h2>
                    <p style="color: #555; margin-bottom: 20px;">
                        Wir freuen uns √ºber eure Beitr√§ge zum Buffet! Bitte tragt ein, was ihr mitbringen m√∂chtet.
                    </p>

                    <div id="buffet-items">
                        <div class="buffet-item">
                            <input type="text" placeholder="z.B. Nudelsalat, Obstsalat, Kuchen..." class="buffet-input">
                            <button type="button" onclick="removeBuffetItem(this)">Entfernen</button>
                        </div>
                    </div>

                    <button type="button" id="add-buffet-item" class="button-secondary" onclick="addBuffetItem()">+ Weiteren Beitrag hinzuf√ºgen</button>

                    <button type="submit" class="button">Anmeldung absenden</button>
                </form>
            </div>
        </div>

        <!-- Vereinfachte Buffet-Sidebar (Rechts) -->
        <div class="sidebar">
            <h3>Bisherige Buffet-Beitr√§ge</h3>
            <ul id="contributionsList" class="contribution-list">
            </ul>
        </div>
    </div>

    <script>
        let buffetItemCount = 1;

        function addBuffetItem() {
            const container = document.getElementById('buffet-items');
            const newItem = document.createElement('div');
            newItem.className = 'buffet-item';
            newItem.innerHTML = `
                <input type="text" placeholder="z.B. Nudelsalat, Obstsalat, Kuchen..." class="buffet-input">
                <button type="button" onclick="removeBuffetItem(this)">Entfernen</button>
            `;
            container.appendChild(newItem);
            buffetItemCount++;
        }

        function removeBuffetItem(button) {
            if (document.querySelectorAll('.buffet-item').length > 1) {
                button.parentElement.remove();
                buffetItemCount--;
            }
        }

        function collectPreferences() {
            // Grillbuffet-Pr√§ferenzen sammeln
            const grillbuffetPreferences = [];
            document.querySelectorAll('[id^="wurst_"]:checked, [id^="fleisch_"]:checked, [id^="veg_"]:checked').forEach(checkbox => {
                grillbuffetPreferences.push(checkbox.value);
            });

            // Getr√§nke-Pr√§ferenzen sammeln
            const getraenkePreferences = [];
            document.querySelectorAll('[id^="soft_"]:checked, [id^="alkfrei_"]:checked, [id^="bier_"]:checked, [id^="wein_"]:checked').forEach(checkbox => {
                getraenkePreferences.push(checkbox.value);
            });

            return {
                grillbuffet_praeferenzen: grillbuffetPreferences,
                grillbuffet_bemerkungen: document.getElementById('grillbuffet_bemerkungen').value,
                getraenke_praeferenzen: getraenkePreferences,
                getraenke_bemerkungen: document.getElementById('getraenke_bemerkungen').value
            };
        }

        async function loadLiveBuffetData() {
            try {
                const response = await fetch('https://sheets.googleapis.com/v4/spreadsheets/1KZJaKLM13kd1Htd8Spxj6fn5KDtNsA5TD86yD55cMhc/values/Anmeldungen?key=AIzaSyDvEjWQ8gJvgHcHY3eqKDkOZAcSgLMgF7Y');
                const data = await response.json();
                
                if (data.values && data.values.length > 1) {
                    const contributionsList = document.getElementById('contributionsList');
                    contributionsList.innerHTML = '';
                    
                    const buffetContributions = new Map();
                    
                    // Daten ab Zeile 2 (Index 1) verarbeiten
                    for (let i = 1; i < data.values.length; i++) {
                        const row = data.values[i];
                        const buffetItems = row[7]; // Spalte H (Index 7)
                        
                        if (buffetItems && buffetItems.trim() !== '') {
                            const items = buffetItems.split(',').map(item => item.trim()).filter(item => item);
                            
                            items.forEach(item => {
                                if (buffetContributions.has(item)) {
                                    buffetContributions.set(item, buffetContributions.get(item) + 1);
                                } else {
                                    buffetContributions.set(item, 1);
                                }
                            });
                        }
                    }
                    
                    // Sortierte Anzeige
                    const sortedContributions = Array.from(buffetContributions.entries())
                        .sort((a, b) => b[1] - a[1] || a[0].localeCompare(b[0]));
                    
                    sortedContributions.forEach(([item, count]) => {
                        const li = document.createElement('li');
                        li.className = 'contribution-item';
                        li.innerHTML = `<strong>${item}</strong> ${count > 1 ? `(${count}x)` : ''}`;
                        contributionsList.appendChild(li);
                    });
                } else {
                    document.getElementById('contributionsList').innerHTML = '<li class="contribution-item">Noch keine Beitr√§ge vorhanden</li>';
                }
            } catch (error) {
                console.error('Fehler beim Laden der Buffet-Daten:', error);
                document.getElementById('contributionsList').innerHTML = '<li class="contribution-item">Fehler beim Laden der Daten</li>';
            }
        }

        document.getElementById('anmeldung-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const submitButton = document.querySelector('button[type="submit"]');
            submitButton.disabled = true;
            submitButton.textContent = 'Wird gesendet...';
            
            const formData = new FormData(this);
            const preferences = collectPreferences();
            
            const buffetItems = Array.from(document.querySelectorAll('.buffet-input'))
                .map(input => input.value.trim())
                .filter(value => value !== '');
            
            const data = {
                name: formData.get('name'),
                email: formData.get('email'),
                loge: formData.get('loge'),
                personen: formData.get('personen'),
                begleitung: formData.get('begleitung'),
                buffet_beitraege: buffetItems.join(', '),
                ...preferences
            };
            
            const urlParams = new URLSearchParams(data).toString();
            window.location.href = `helfer.html?${urlParams}`;
        });

        // Lade Buffet-Daten beim Seitenaufruf
        window.addEventListener('load', loadLiveBuffetData);
    </script>
</body>
</html>
